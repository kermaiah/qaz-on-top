local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local Workspace = game:GetService("Workspace")

local autoPressEnabled = false

local ENABLED_CFRAME = CFrame.new(561.808411, 1.90603209, -280.448639, 0, 0, -1, 0, 1, 0, 1, 0, 0)
local ENABLED_SIZE = Vector3.new(10, 10, 10)

local DISABLED_CFRAME = CFrame.new(546.966064, -0.535936713, -396.153412, 3.57627869e-07, -0.999999285, -0.0012207774, 1, 3.57627869e-07, 2.32830644e-10, 2.32830644e-10, -0.0012207774, 0.999999225)
local DISABLED_SIZE = Vector3.new(1.3463988304138184, 7.32063102722168, 7.2016777992248535)

local function notifyStatus(status)
	local title = "Status: " .. tostring(status)
	local text = status and "on'ed na nh'ay" or "off'ed na nh'ay"

	pcall(function()
		StarterGui:SetCore("SendNotification", {
			Title = title,
			Text = text,
			Duration = 4
		})
	end)
end

local function notifyInstructions()
	pcall(function()
		StarterGui:SetCore("SendNotification", {
			Title = "money spawn pa, report kita",
			Text = "pindutin mo [F] nh'ay'ed para on/off",
			Duration = 5
		})
	end)
end

local function waitForParts()
	repeat task.wait() until Workspace:FindFirstChild("System")
		and Workspace.System:FindFirstChild("DeliveryBoxes")
		and Workspace.System.DeliveryBoxes:FindFirstChild("MainObjects")
		and Workspace.System.DeliveryBoxes.MainObjects:FindFirstChild("TargetPart")
		and Workspace.System.DeliveryBoxes.MainObjects:FindFirstChild("GetJobPart")
		and Workspace.System.DeliveryBoxes.MainObjects.GetJobPart:FindFirstChild("ProximityPrompt")

	local part = Workspace.System.DeliveryBoxes.MainObjects.TargetPart
	local prompt = Workspace.System.DeliveryBoxes.MainObjects.GetJobPart.ProximityPrompt

	-- Duplicate the part once, parent it to the same container
	local partDuplicate = part:Clone()
	partDuplicate.Name = part.Name .. "_Duplicate"
	partDuplicate.Parent = part.Parent
	partDuplicate.Transparency = 1
	partDuplicate.CanCollide = false

	return part, partDuplicate, prompt
end

local function setPartTransform(part, partDuplicate)
	if autoPressEnabled then
		part.CFrame = ENABLED_CFRAME
		part.Size = ENABLED_SIZE
		part.Transparency = 1
		partDuplicate.Transparency = 0.4
	else
		part.CFrame = DISABLED_CFRAME
		part.Size = DISABLED_SIZE
		part.Transparency = 0.4
		partDuplicate.Transparency = 1
	end
end

local function watchPart(part)
	part.AncestryChanged:Connect(function()
		task.wait(0.1)
		if part:IsDescendantOf(Workspace) then
			setPartTransform(part)
		end
	end)

	part:GetPropertyChangedSignal("Parent"):Connect(function()
		task.wait(0.1)
		if part:IsDescendantOf(Workspace) then
			setPartTransform(part)
		end
	end)
end

local part, partDuplicate, prompt = waitForParts()
setPartTransform(part, partDuplicate)
watchPart(part)
notifyInstructions()

UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if not gameProcessed and input.KeyCode == Enum.KeyCode.F then
		autoPressEnabled = not autoPressEnabled
		notifyStatus(autoPressEnabled)
		setPartTransform(part, partDuplicate)
	end
end)

RunService.Heartbeat:Connect(function()
	if autoPressEnabled and prompt and prompt:IsDescendantOf(Workspace) then
		pcall(function()
			prompt:InputHoldBegin(Enum.UserInputType.Keyboard, Enum.KeyCode.E)
			task.wait(0.1)
			prompt:InputHoldEnd(Enum.UserInputType.Keyboard, Enum.KeyCode.E)
		end)
	end
end)
